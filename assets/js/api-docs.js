window.onload=function(){var a="http://api.powderlin.es",b="http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",c='Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery &copy; <a href="http://cloudmade.com">CloudMade</a>',d=18,e=L.map("map",{center:[39.8282,-98.5795],zoom:4,scrollWheelZoom:!1});L.tileLayer(b,{attribution:c,maxZoom:d}).addTo(e),$.ajax({url:a+"/stations",jsonp:"callback",dataType:"jsonp",success:function(a){$.each(a,function(a,b){var c=b.location.lat,d=b.location.lng,g=L.latLng(c,d),h=L.marker(g);setTimeout(function(){h.addTo(e);var a="<h6>"+b.name+"</h6>Elevation: "+b.elevation+"ft<br>Triplet: "+b.triplet;h.bindPopup(a),h.on("click",function(){f(b.triplet)})},200*a)})}});var f=function(b){function c(a){return f=Flotr._.extend(Flotr._.clone(d),a||{}),Flotr.draw(h,[g],f)}$("#graph .placeholder-rectangle").html("Loading&hellip;");var d,e,f,g=[],h=document.getElementById("graph");$.ajax({url:a+"/station/"+b,jsonp:"callback",dataType:"jsonp",data:{days:100},success:function(a){var b=0,d=2;$.each(a.data,function(){g.push([new Date(this.Date).getTime(),this["Snow Depth (in)"]]),this["Snow Depth (in)"]>b&&(b=parseFloat(this["Snow Depth (in)"],10)),e=c({yaxis:{max:b+d}})})}}),d={shadowSize:0,lines:{fill:!0,show:!1,lineWidth:0,color:"#ccc",fillColor:"#ccc"},xaxis:{mode:"time",labelsAngle:45},yaxis:{min:0,max:200},selection:{mode:"x"},HtmlText:!1,title:"Snow Depth (in)"},Flotr.EventAdapter.observe(h,"flotr:select",function(a){e=c({xaxis:{min:a.x1,max:a.x2,mode:"time",labelsAngle:45},yaxis:{min:a.y1,max:a.y2}})}),Flotr.EventAdapter.observe(h,"flotr:click",function(){e=c()})}};